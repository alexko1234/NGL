//created on: Mar 15, 2019
package rules

rule "set Type de run"
    @nglSQ( calculations )
	dialect "java"
	salience 200
	no-loop
	when
    	$experiment:Experiment($typeCode:typeCode,$typeCode=="nanopore-depot", $stateCode : state.code, $stateCode=="N", $experimentProp: experimentProperties);
    	$atomicTransfert: ManyToOneContainer(inputContainerUseds!=null, $inputContainerUseds:inputContainerUseds);
		OutputContainerUsed( $experimentPropertiesOut : experimentProperties, $experimentPropertiesOut != null) from $atomicTransfert.outputContainerUseds
    	
    then
   		PropertySingleValue value;
   		
   		if($inputContainerUseds.size() > 1){
   			value = new PropertySingleValue("MTPLX");
	   	} else {
   			value = new PropertySingleValue("SPLX");
	   	}
	   	
	   	if($experimentPropertiesOut.get("runType") != null){
	   		$experimentPropertiesOut.remove("runType");
	   	}
	   	$experimentPropertiesOut.put("runType",value);
	   	
    end